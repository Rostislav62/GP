<!-- /GuildPost/posts/templates/posts/article_detail.html -->
{% load static %}
<div class="article-detail">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞—Ç—å–∏ –∏  –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è" -->
    <div class="article-header">
        <div class="author-avatar">
            {% if article.author.profile.avatar %}
                <img src="{{ article.author.profile.avatar.url }}" alt="Avatar">
            {% else %}
                <img src="{% static 'pictures/avatar.webp' %}" alt="Default Avatar">
            {% endif %}
        </div>
        <div class="author-info">
            <p class="author-name">{{ article.author.first_name }} {{ article.author.last_name }}</p>
            <p class="category">{{ article.category.name }}</p>
        </div>


        <table style="width: 100%;">
            <tr>
                <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
                <td style="text-align: left; vertical-align: middle;">
                    <h1 class="article-title">{{ article.title }}</h1>
                </td>
                <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –ö–Ω–æ–ø–∫–∞ -->
                <td style="text-align: right; vertical-align: middle;">
                    <button class="btn-follow">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
                </td>
            </tr>
        </table>
    </div>


    <!-- –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏ -->
    <div class="article-content">
        {{ article.content|safe }}  <!-- –†–µ–Ω–¥–µ—Ä–∏–º HTML-–∫–æ–Ω—Ç–µ–Ω—Ç -->
    </div>

    <!-- –õ–∞–π–∫–∏, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, –ø—Ä–æ—Å–º–æ—Ç—Ä—ã -->
    <div>
        <button class="btn-views">üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä—ã: {{ article.views_count }}</button>
        <button class="btn-like">üëç –õ–∞–π–∫  {{ article.likes_count }}</button>
        <button class="btn-comment clickable" data-url="{% url 'all_comments' article.id %}">
    üí¨       –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏: {{ article.comments.count }}
        </button>


    </div>

    {% if user.is_authenticated and user == article.author %}
        <div class="article-actions">
    <!-- –ö–Ω–æ–ø–∫–∞ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" –¥–ª—è –∞–≤—Ç–æ—Ä–∞ –ø–æ—Å—Ç–∞ -->
        <button class="menu-item clickable edit-article btn-edit"
                data-article-id="{{ article.id }}"
                data-url="{% url 'edit_ad' article.id %}">
            ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
        </button>
        <!-- –ö–Ω–æ–ø–∫–∞ "–£–¥–∞–ª–∏—Ç—å" -->
        <button class="btn-delete clickable"
                data-article-id="{{ article.id }}"
                data-url="{% url 'delete_article' article.id %}"
                onclick="confirmDelete(this)">
            üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
        </button>

        </div>
    {% endif %}

    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–π –æ–¥–æ–±—Ä–µ–Ω–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π -->
    {% if latest_comment %}
        <h3 id="latest-comment" class="comment-preview clickable" data-url="{% url 'all_comments' article.id %}">
            –ü–æ—Å–ª–µ–¥–Ω–∏–π –æ–¥–æ–±—Ä–µ–Ω–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: <strong>{{ latest_comment.author.username }}</strong> -
            {{ latest_comment.updated_at|default:latest_comment.created_at|date:"d M Y H:i" }}
        </h3>
        <p class="clickable" data-url="{% url 'all_comments' article.id %}">
            {{ latest_comment.content|truncatewords:15 }}
        </p>
    {% else %}
        <p>–ü–æ–∫–∞ –Ω–µ—Ç –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤.</p>
    {% endif %}

<!-- –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏" –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Å—Ç–∞—Ç—å–∏ -->
{% if user.is_authenticated and user == article.author %}
    <p><a href="{% url 'all_comments' article.id %}">üìÑ –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</a></p>
{% endif %}



    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è -->

    {% if user.is_authenticated %}
        <form id="add-comment-form" method="POST" data-url="{% url 'add_comment' article.id %}">
            {% csrf_token %}
            <textarea name="comment" rows="3" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..."></textarea>
            <button type="submit">
                <i class="fas fa-paper-plane"></i> –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
            </button>
        </form>
    {% else %}
        <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, <a href="{% url 'login' %}">–≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É</a>, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π.</p>
    {% endif %}

</div>



<!-- /GuildPost/posts/templates/posts/article_detail.html -->
{% load static %}
<div class="article-detail">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç–∞—Ç—å–∏ –∏  –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è" -->
    <div class="article-header">
        <div class="author-avatar">
            {% if article.author.profile.avatar %}
                <img src="{{ article.author.profile.avatar.url }}" alt="Avatar">
            {% else %}
                <img src="{% static 'pictures/avatar.webp' %}" alt="Default Avatar">
            {% endif %}
        </div>
        <div class="author-info">
            <p class="author-name">{{ article.author.first_name }} {{ article.author.last_name }}</p>
            <p class="category">{{ article.category.name }}</p>
        </div>


        <table style="width: 100%;">
            <tr>
                <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
                <td style="text-align: left; vertical-align: middle;">
                    <h1 class="article-title">{{ article.title }}</h1>
                </td>
                <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –ö–Ω–æ–ø–∫–∞ -->
                <td style="text-align: right; vertical-align: middle;">
                    <button class="btn-follow">–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è</button>
                </td>
            </tr>
        </table>
    </div>


    <!-- –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏ -->
    <p>{{ article.content }}</p>

    <!-- –ú–µ–¥–∏–∞—Ñ–∞–π–ª: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–ª–∏ –≤–∏–¥–µ–æ -->
    <div class="media-container">
        {% if article.media_file %}
            {% if media_type == 'image' %}
                <img src="{{ article.media_file.url }}" alt="Article Media" class="article-media">
            {% elif media_type == 'video' %}
                <video src="{{ article.media_file.url }}" controls class="article-media"></video>
            {% endif %}
        {% endif %}
    </div>
    <div>

    </div>
    <!-- –õ–∞–π–∫–∏, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏, –ø—Ä–æ—Å–º–æ—Ç—Ä—ã -->
    <div>
        <button class="btn-views">üëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä—ã: {{ article.views_count }}</button>
        <button class="btn-like">üëç –õ–∞–π–∫  {{ article.likes_count }}</button>
        <button class="btn-comment clickable" data-url="{% url 'all_comments' article.id %}">
    üí¨       –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏: {{ article.comments.count }}
        </button>


    </div>

    {% if user.is_authenticated and user == article.author %}
    <!-- –ö–Ω–æ–ø–∫–∞ "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" –¥–ª—è –∞–≤—Ç–æ—Ä–∞ –ø–æ—Å—Ç–∞ -->
    <button class="menu-item clickable edit-article"
            data-article-id="{{ article.id }}"
            data-url="{% url 'edit_ad' article.id %}">
        –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
    </button>
    {% endif %}

    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π -->
    {% if latest_comment %}
        <h3 id="latest-comment" class="comment-preview clickable" data-url="{% url 'all_comments' article.id %}">
            –ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: <strong>{{ latest_comment.author.username }}</strong> -
            {{ latest_comment.updated_at|default:latest_comment.created_at|date:"d M Y H:i" }}
        </h3>
        <p class="clickable" data-url="{% url 'all_comments' article.id %}">
            {{ latest_comment.content|truncatewords:15 }} <!-- –¢–µ–∫—Å—Ç –æ–±—Ä–µ–∑–∞–µ—Ç—Å—è –¥–æ 15 —Å–ª–æ–≤ -->
        </p>
    {% else %}
        <p>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ–∫–∞ –Ω–µ—Ç.</p> <!-- –¢–µ–∫—Å—Ç, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–π –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->
    {% endif %}



    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è -->

    {% if user.is_authenticated %}
        <form id="add-comment-form" method="POST" data-url="{% url 'add_comment' article.id %}">
            {% csrf_token %}
            <textarea name="comment" rows="3" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..."></textarea>
            <button type="submit">
                <i class="fas fa-paper-plane"></i> –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
            </button>
        </form>
    {% else %}
        <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, <a href="{% url 'login' %}">–≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É</a>, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π.</p>
    {% endif %}



    </form>
</div>



(()=>{"use strict";var e={d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(){m("/posts/articles/",(function(){document.querySelectorAll(".load-article").forEach((function(e){e.addEventListener("click",(function(){var e=this.getAttribute("data-article-id"),t=this.getAttribute("data-url")||"/posts/articles/".concat(e,"/");t&&m(t,(function(){console.log("Контент статьи загружен с URL: ".concat(t))}))}))}))}))}function o(){var e=document.querySelectorAll(".menu-item");e&&0!==e.length?e.forEach((function(e){e.addEventListener("click",(function(){return function(e){var t=e.dataset.link;"grid"===t||"list"===t?function(e){var t=document.querySelector(".articles-container");if(!t)return void console.error("Контейнер статей не найден!");"grid"===e?(t.classList.add("grid-view"),t.classList.remove("list-view"),localStorage.setItem("viewMode","grid")):"list"===e&&(t.classList.add("list-view"),t.classList.remove("grid-view"),localStorage.setItem("viewMode","list"))}(t):console.warn("Неподдерживаемое действие:",t)}(e)}))})):console.error("Элементы меню не найдены!")}function r(){var e=document.querySelector("#forgot-password-link");e&&e.addEventListener("click",(function(e){e.preventDefault(),m("/recovery-password/",(function(){var e;(e=document.querySelector("#recovery-request-form"))&&setupFormSubmission(e,"/password-recovery-request/",n),setupBackToSignInLink()}))}))}function n(){var e=document.querySelector("#recovery-code-form");e&&setupFormSubmission(e,"/password-recovery-code/",setupPasswordChangeForm)}function i(){var e=document.querySelector("#register-form");e&&setupFormSubmission(e,"/register/",c)}function c(){var e=document.querySelector("#activation-form");e&&setupFormSubmission(e,"/activate/")}function a(e){document.body.setAttribute("data-theme",e)}function s(e,t){"light"===t?(e.setAttribute("data-theme","light"),e.innerHTML='<i class="fas fa-moon"></i> <span>Тёмная тема</span>'):(e.setAttribute("data-theme","dark"),e.innerHTML='<i class="fas fa-sun"></i> <span>Светлая тема</span>')}function l(){document.addEventListener("click",(function(e){var t,o,r,n=e.target;if(n.matches("#add-comment-form button[type='submit']")){e.preventDefault();var i=n.closest("#add-comment-form");i&&(o=(t=i).getAttribute("data-url"),r=new FormData(t),console.log("Отправка комментария через AJAX..."),fetch(o,{method:"POST",body:r,headers:{"X-Requested-With":"XMLHttpRequest"}}).then((function(e){if(!e.ok)throw new Error("Ошибка: ".concat(e.statusText));return e.text()})).then((function(e){document.querySelector(".main-box").innerHTML=e,console.log("Комментарий добавлен и страница обновлена.")})).catch((function(e){console.error("Ошибка при добавлении комментария:",e)})))}}))}function u(e){var t=document.querySelector(".main");t?"list"===e?(t.classList.add("list"),t.classList.remove("grid")):"grid"===e&&(t.classList.add("grid"),t.classList.remove("list")):console.error("Элемент .main не найден!")}function d(e,t){"grid"===t?(e.setAttribute("data-mode","grid"),e.innerHTML='<i class="fas fa-th"></i> <span>Плитка</span>'):(e.setAttribute("data-mode","list"),e.innerHTML='<i class="fas fa-bars"></i> <span>Список</span>')}function m(e,t){var o=document.querySelector(".main-box");fetch(e).then((function(e){if(!e.ok)throw new Error("Ошибка загрузки контента: ".concat(e.statusText));return e.text()})).then((function(r){o.innerHTML=r,console.log("Контент успешно загружен с URL: ".concat(e)),t&&t()})).catch((function(e){console.error("Ошибка загрузки:",e),o.innerHTML='<div class="error">Не удалось загрузить содержимое. Попробуйте позже.</div>'}))}e.d({},{K:()=>m}),document.addEventListener("DOMContentLoaded",(function(){var e,n;console.log("Инициализация приложения..."),o(),(e=document.querySelector('.menu-item[data-link="home"]'))?e.addEventListener("click",(function(e){e.preventDefault(),t()})):console.error('Кнопка "Главная" не найдена!'),function(){var e=document.querySelector(".theme-toggle");if(e){var t=localStorage.getItem("theme")||"light";a(t),s(e,t),e.addEventListener("click",(function(){var t="dark"===e.getAttribute("data-theme")?"light":"dark";a(t),s(e,t),localStorage.setItem("theme",t)}))}else console.error("Кнопка переключения темы не найдена!")}(),function(){var e=document.querySelector(".toggle-view-mode");if(e){var t=localStorage.getItem("mode")||"list";u(t),d(e,t),e.addEventListener("click",(function(){var t="list"===e.getAttribute("data-mode")?"grid":"list";u(t),d(e,t),localStorage.setItem("mode",t)}))}else console.error("Кнопка переключателя режима Список/Плитка не найдена!")}(),t(),(n=document.getElementById("registration-link"))&&n.addEventListener("click",(function(e){e.preventDefault(),m("/register/",i)})),r(),l(),console.log("Инициализация завершена.")}))})();